# vmware-esxi-tools

## esxi-anonymizer.sh

### usage
```
$ ./esxi-anonymizer.sh  /vmfs/volumes/ds-local-esxi01/ ./reports
baseWorkingDirectory: ./reports
datastrorePath: /vmfs/volumes/ds-local-esxi01/
sessionName: 20221224_135724
sessionWrkDir: ./reports/20221224_135724 created successfully
baseDictAnonFile: ./bip39-english.dictionary.txt
baseDictAnonRndm: radomize anonymous base dictionary
findCmdCheck: got recursive access on /vmfs/volumes/ds-local-esxi01/
startFilter: just-a-simple-fil3r
extensionsFiter: log|nvram|sf|vmdk|vmsd|vmsn|vmx|vmxf|xml
vmwareFiler: vmware|aux|flat|quiesce|manifest|sesparse|snapshot|delta|rdmp|rdm|iscsi
origWordsFilter: alpine|ds|esxi01|extra|fbb|fdc|jbc|linux|local|pb2|pbc|rstr|sbc|tomy|vh|vmfs|volumes|winxp
origWordsCount: 18
anonWordsCount: 2048
origTmpDict: ./reports/20221224_135724/orig-words.txt
anonTmpDict: ./reports/20221224_135724/anon-words.txt
sedCmdEncWords: ./reports/20221224_135724/session-encrypt.sed
sedCmdDecWords: ./reports/20221224_135724/session-decrypt.sed
origInFile: ./reports/20221224_135724/original-input.txt
anonOutFile: ./reports/20221224_135724/anonymous-output.txt
revertedFile: ./reports/20221224_135724/anonymous-revert.txt
reportNote: please check if your data output is anonymized before sending it out
reportNote: VMware might change grep, sed, find, awki, echo, diff implementation
origInSha256Check: 2a93712ddb6b02d31e8f7a1607b8b6122fd3852b32e5d414338f626caa65d3be
encDecSha256Check: 2a93712ddb6b02d31e8f7a1607b8b6122fd3852b32e5d414338f626caa65d3be
sessionResult: SUCCESS! decoded anonymized report is identical to original report
diffCheck: ./reports/20221224_135724/original-input.txt vs ./reports/20221224_135724/anonymous-revert.txt
Files ./reports/20221224_135724/original-input.txt and ./reports/20221224_135724/anonymous-revert.txt are identical
```

### input dictionary

input words extracted from files names whithout extensions of vmware reserved words

```
$ cat ./reports/20221224_135705/orig-words.txt
alpine
ds
esxi01
extra
fbb
fdc
jbc
linux
local
pb2
pbc
rstr
sbc
tomy
vh
vmfs
volumes
winxp
```

### encoding dictionary

encoding words extracted from a bip39 dictionary then randomized then filter not to overlap with input words

```
$ cat ./reports/20221224_135724/anon-words.txt
limit
will
toy
normal
scale
help
curtain
entire
chest
frame
into
emerge
lonely
rebuild
behind
friend
green
menu
```

### encoding script

generated based on encoding words for sed command

```
cat ./reports/20221224_135724/session-encrypt.sed
s/\balpine\b/limit/g
s/\bds\b/will/g
s/\besxi01\b/toy/g
s/\bextra\b/normal/g
s/\bfbb\b/scale/g
s/\bfdc\b/help/g
s/\bjbc\b/curtain/g
s/\blinux\b/entire/g
s/\blocal\b/chest/g
s/\bpb2\b/frame/g
s/\bpbc\b/into/g
s/\brstr\b/emerge/g
s/\bsbc\b/lonely/g
s/\btomy\b/rebuild/g
s/\bvh\b/behind/g
s/\bvmfs\b/friend/g
s/\bvolumes\b/green/g
s/\bwinxp\b/menu/g
```

## decoding script

generated based on decoding words for sed command

```
cat ./reports/20221224_135705/session-decrypt.sed
s/\bbecause\b/alpine/g
s/\bcompany\b/ds/g
s/\bremain\b/esxi01/g
s/\bproblem\b/extra/g
s/\bstrategy\b/fbb/g
s/\bbrush\b/fdc/g
s/\bshiver\b/jbc/g
s/\bbudget\b/linux/g
s/\bslim\b/local/g
s/\bbrown\b/pb2/g
s/\btry\b/pbc/g
s/\beasy\b/rstr/g
s/\benhance\b/sbc/g
s/\bguitar\b/tomy/g
s/\bfish\b/vh/g
s/\bvillage\b/vmfs/g
s/\bgrit\b/volumes/g
s/\bsplit\b/winxp/g
```

### input file

generated by find -type f /on/a/path/specified/as/parameter

```
$ cat ./reports/20221224_135724/original-input.txt
/vmfs/volumes/ds-local-esxi01/.fbb.sf
/vmfs/volumes/ds-local-esxi01/.fdc.sf
/vmfs/volumes/ds-local-esxi01/.jbc.sf
/vmfs/volumes/ds-local-esxi01/.pb2.sf
/vmfs/volumes/ds-local-esxi01/.pbc.sf
/vmfs/volumes/ds-local-esxi01/.sbc.sf
/vmfs/volumes/ds-local-esxi01/.vh.sf
/vmfs/volumes/ds-local-esxi01/tomy-linux/alpine-000001-sesparse.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/alpine-000001.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/alpine-000002-sesparse.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/alpine-000002.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/alpine-000003-sesparse.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/alpine-000003.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/alpine-000004-sesparse.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/alpine-000004.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/alpine-000005-sesparse.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/alpine-000005.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/alpine-flat.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/alpine.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/extra-000001-sesparse.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/extra-000001.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/extra-000002-sesparse.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/extra-000002.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/extra-flat.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/extra.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-linux/tomy-linux-Snapshot2.vmsn
/vmfs/volumes/ds-local-esxi01/tomy-linux/tomy-linux-Snapshot3.vmsn
/vmfs/volumes/ds-local-esxi01/tomy-linux/tomy-linux-Snapshot4.vmsn
/vmfs/volumes/ds-local-esxi01/tomy-linux/tomy-linux-Snapshot5.vmsn
/vmfs/volumes/ds-local-esxi01/tomy-linux/tomy-linux-Snapshot6.vmsn
/vmfs/volumes/ds-local-esxi01/tomy-linux/tomy-linux-aux.xml
/vmfs/volumes/ds-local-esxi01/tomy-linux/tomy-linux.nvram
/vmfs/volumes/ds-local-esxi01/tomy-linux/tomy-linux.vmsd
/vmfs/volumes/ds-local-esxi01/tomy-linux/tomy-linux.vmx
/vmfs/volumes/ds-local-esxi01/tomy-linux/vmware-3.log
/vmfs/volumes/ds-local-esxi01/tomy-linux/vmware-4.log
/vmfs/volumes/ds-local-esxi01/tomy-linux/vmware-5.log
/vmfs/volumes/ds-local-esxi01/tomy-linux/vmware-6.log
/vmfs/volumes/ds-local-esxi01/tomy-linux/vmware-7.log
/vmfs/volumes/ds-local-esxi01/tomy-linux/vmware-8.log
/vmfs/volumes/ds-local-esxi01/tomy-linux/vmware.log
/vmfs/volumes/ds-local-esxi01/tomy-rstr/alpine-flat.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-rstr/alpine.vmdk
/vmfs/volumes/ds-local-esxi01/tomy-rstr/tomy-rstr.nvram
/vmfs/volumes/ds-local-esxi01/tomy-rstr/tomy-rstr.vmsd
/vmfs/volumes/ds-local-esxi01/tomy-rstr/tomy-rstr.vmx
/vmfs/volumes/ds-local-esxi01/tomy-rstr/vmware-22.log
/vmfs/volumes/ds-local-esxi01/tomy-rstr/vmware-23.log
/vmfs/volumes/ds-local-esxi01/tomy-rstr/vmware-24.log
/vmfs/volumes/ds-local-esxi01/tomy-rstr/vmware-25.log
/vmfs/volumes/ds-local-esxi01/tomy-rstr/vmware-26.log
/vmfs/volumes/ds-local-esxi01/tomy-rstr/vmware-27.log
/vmfs/volumes/ds-local-esxi01/tomy-rstr/vmware.log
/vmfs/volumes/ds-local-esxi01/winxp/vmware-4.log
/vmfs/volumes/ds-local-esxi01/winxp/vmware-5.log
/vmfs/volumes/ds-local-esxi01/winxp/vmware-6.log
/vmfs/volumes/ds-local-esxi01/winxp/vmware-7.log
/vmfs/volumes/ds-local-esxi01/winxp/vmware-8.log
/vmfs/volumes/ds-local-esxi01/winxp/vmware-9.log
/vmfs/volumes/ds-local-esxi01/winxp/vmware.log
/vmfs/volumes/ds-local-esxi01/winxp/winxp-000001-sesparse.vmdk
/vmfs/volumes/ds-local-esxi01/winxp/winxp-000001.vmdk
/vmfs/volumes/ds-local-esxi01/winxp/winxp-000002-sesparse.vmdk
/vmfs/volumes/ds-local-esxi01/winxp/winxp-000002.vmdk
/vmfs/volumes/ds-local-esxi01/winxp/winxp-000003-sesparse.vmdk
/vmfs/volumes/ds-local-esxi01/winxp/winxp-000003.vmdk
/vmfs/volumes/ds-local-esxi01/winxp/winxp-000004-sesparse.vmdk
/vmfs/volumes/ds-local-esxi01/winxp/winxp-000004.vmdk
/vmfs/volumes/ds-local-esxi01/winxp/winxp-Snapshot1.vmsn
/vmfs/volumes/ds-local-esxi01/winxp/winxp-Snapshot2.vmsn
/vmfs/volumes/ds-local-esxi01/winxp/winxp-Snapshot3.vmsn
/vmfs/volumes/ds-local-esxi01/winxp/winxp-Snapshot4.vmsn
/vmfs/volumes/ds-local-esxi01/winxp/winxp-flat.vmdk
/vmfs/volumes/ds-local-esxi01/winxp/winxp.nvram
/vmfs/volumes/ds-local-esxi01/winxp/winxp.vmdk
/vmfs/volumes/ds-local-esxi01/winxp/winxp.vmsd
/vmfs/volumes/ds-local-esxi01/winxp/winxp.vmx
/vmfs/volumes/ds-local-esxi01/winxp/winxp.vmxf
```


### encoded output
```
cat ./reports/20221224_135705/anonymous-output.txt
/village/grit/company-slim-remain/.strategy.sf
/village/grit/company-slim-remain/.brush.sf
/village/grit/company-slim-remain/.shiver.sf
/village/grit/company-slim-remain/.brown.sf
/village/grit/company-slim-remain/.try.sf
/village/grit/company-slim-remain/.enhance.sf
/village/grit/company-slim-remain/.fish.sf
/village/grit/company-slim-remain/guitar-budget/because-000001-sesparse.vmdk
/village/grit/company-slim-remain/guitar-budget/because-000001.vmdk
/village/grit/company-slim-remain/guitar-budget/because-000002-sesparse.vmdk
/village/grit/company-slim-remain/guitar-budget/because-000002.vmdk
/village/grit/company-slim-remain/guitar-budget/because-000003-sesparse.vmdk
/village/grit/company-slim-remain/guitar-budget/because-000003.vmdk
/village/grit/company-slim-remain/guitar-budget/because-000004-sesparse.vmdk
/village/grit/company-slim-remain/guitar-budget/because-000004.vmdk
/village/grit/company-slim-remain/guitar-budget/because-000005-sesparse.vmdk
/village/grit/company-slim-remain/guitar-budget/because-000005.vmdk
/village/grit/company-slim-remain/guitar-budget/because-flat.vmdk
/village/grit/company-slim-remain/guitar-budget/because.vmdk
/village/grit/company-slim-remain/guitar-budget/problem-000001-sesparse.vmdk
/village/grit/company-slim-remain/guitar-budget/problem-000001.vmdk
/village/grit/company-slim-remain/guitar-budget/problem-000002-sesparse.vmdk
/village/grit/company-slim-remain/guitar-budget/problem-000002.vmdk
/village/grit/company-slim-remain/guitar-budget/problem-flat.vmdk
/village/grit/company-slim-remain/guitar-budget/problem.vmdk
/village/grit/company-slim-remain/guitar-budget/guitar-budget-Snapshot2.vmsn
/village/grit/company-slim-remain/guitar-budget/guitar-budget-Snapshot3.vmsn
/village/grit/company-slim-remain/guitar-budget/guitar-budget-Snapshot4.vmsn
/village/grit/company-slim-remain/guitar-budget/guitar-budget-Snapshot5.vmsn
/village/grit/company-slim-remain/guitar-budget/guitar-budget-Snapshot6.vmsn
/village/grit/company-slim-remain/guitar-budget/guitar-budget-aux.xml
/village/grit/company-slim-remain/guitar-budget/guitar-budget.nvram
/village/grit/company-slim-remain/guitar-budget/guitar-budget.vmsd
/village/grit/company-slim-remain/guitar-budget/guitar-budget.vmx
/village/grit/company-slim-remain/guitar-budget/vmware-3.log
/village/grit/company-slim-remain/guitar-budget/vmware-4.log
/village/grit/company-slim-remain/guitar-budget/vmware-5.log
/village/grit/company-slim-remain/guitar-budget/vmware-6.log
/village/grit/company-slim-remain/guitar-budget/vmware-7.log
/village/grit/company-slim-remain/guitar-budget/vmware-8.log
/village/grit/company-slim-remain/guitar-budget/vmware.log
/village/grit/company-slim-remain/guitar-easy/because-flat.vmdk
/village/grit/company-slim-remain/guitar-easy/because.vmdk
/village/grit/company-slim-remain/guitar-easy/guitar-easy.nvram
/village/grit/company-slim-remain/guitar-easy/guitar-easy.vmsd
/village/grit/company-slim-remain/guitar-easy/guitar-easy.vmx
/village/grit/company-slim-remain/guitar-easy/vmware-22.log
/village/grit/company-slim-remain/guitar-easy/vmware-23.log
/village/grit/company-slim-remain/guitar-easy/vmware-24.log
/village/grit/company-slim-remain/guitar-easy/vmware-25.log
/village/grit/company-slim-remain/guitar-easy/vmware-26.log
/village/grit/company-slim-remain/guitar-easy/vmware-27.log
/village/grit/company-slim-remain/guitar-easy/vmware.log
/village/grit/company-slim-remain/split/vmware-4.log
/village/grit/company-slim-remain/split/vmware-5.log
/village/grit/company-slim-remain/split/vmware-6.log
/village/grit/company-slim-remain/split/vmware-7.log
/village/grit/company-slim-remain/split/vmware-8.log
/village/grit/company-slim-remain/split/vmware-9.log
/village/grit/company-slim-remain/split/vmware.log
/village/grit/company-slim-remain/split/split-000001-sesparse.vmdk
/village/grit/company-slim-remain/split/split-000001.vmdk
/village/grit/company-slim-remain/split/split-000002-sesparse.vmdk
/village/grit/company-slim-remain/split/split-000002.vmdk
/village/grit/company-slim-remain/split/split-000003-sesparse.vmdk
/village/grit/company-slim-remain/split/split-000003.vmdk
/village/grit/company-slim-remain/split/split-000004-sesparse.vmdk
/village/grit/company-slim-remain/split/split-000004.vmdk
/village/grit/company-slim-remain/split/split-Snapshot1.vmsn
/village/grit/company-slim-remain/split/split-Snapshot2.vmsn
/village/grit/company-slim-remain/split/split-Snapshot3.vmsn
/village/grit/company-slim-remain/split/split-Snapshot4.vmsn
/village/grit/company-slim-remain/split/split-flat.vmdk
/village/grit/company-slim-remain/split/split.nvram
/village/grit/company-slim-remain/split/split.vmdk
/village/grit/company-slim-remain/split/split.vmsd
/village/grit/company-slim-remain/split/split.vmx
/village/grit/company-slim-remain/split/split.vmxf
```

### sessions

sessions are saved automatically

```
ls -al ./reports/20221224_135705/
total 68
drwxr-xr-x    2 root     root          4096 Dec 24 13:57 .
drwxr-xr-x  146 root     root          4096 Dec 24 13:57 ..
-rw-r--r--    1 root     root         13116 Dec 24 13:57 anon-words.dictionary.txt
-rw-r--r--    1 root     root           119 Dec 24 13:57 anon-words.txt
-rw-r--r--    1 root     root          4814 Dec 24 13:57 anonymous-output.txt
-rw-r--r--    1 root     root          4299 Dec 24 13:57 anonymous-revert.txt
-rw-r--r--    1 root     root            91 Dec 24 13:57 orig-words.dictionary.txt
-rw-r--r--    1 root     root            91 Dec 24 13:57 orig-words.txt
-rw-r--r--    1 root     root          4299 Dec 24 13:57 original-input.txt
-rw-r--r--    1 root     root           354 Dec 24 13:57 session-decrypt.sed
-rw-r--r--    1 root     root           354 Dec 24 13:57 session-encrypt.sed
```
